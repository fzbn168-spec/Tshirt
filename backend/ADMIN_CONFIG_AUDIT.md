# 后端管理功能可配置性审计报告 (Admin Configuration Audit Report)

**日期**: 2026-02-13
**对象**: 后端各业务模块
**目的**: 梳理系统各模块功能的“可配置性”，明确哪些可以在后台自由更改（动态），哪些需要修改代码（静态）。

---

## 1. 核心结论摘要

目前系统呈现 **“数据动态化，逻辑静态化”** 的特征：
*   ✅ **高度动态化**: 商品管理、属性管理、用户管理（基于数据库，有 CRUD 接口）。
*   ⚠️ **混合模式**: 订单流程、支付逻辑（状态流转写死在代码中，但数据存库）。
*   ❌ **完全静态化**: 基础设施配置（SMTP 邮件、Stripe 密钥）、核心业务规则（MOQ 校验逻辑、阶梯定价计算规则）。

---

## 2. 详细模块审计表

### 🛠️ 基础设施与系统设置 (System & Infrastructure)

| 功能点 | 当前状态 | 配置方式 | 灵活度 | 说明 |
| :--- | :--- | :--- | :--- | :--- |
| **邮件服务 (SMTP)** | 🔴 静态 | `.env` 环境变量 | 低 | 更换服务商需改服务器配置并重启。 |
| **支付网关 (Stripe)** | 🔴 静态 | `.env` 环境变量 | 低 | API Key 更换需重启。 |
| **文件上传 (Uploads)** | 🔴 静态 | 代码逻辑 (Local Disk) | 低 | 存储路径和大小限制写在代码中。 |
| **汇率管理 (Exchange)** | 🟠 混合 | 数据库 + 定时任务 | 中 | 数据库支持存储，但缺后台手动覆写界面。 |
| **多语言 (I18n)** | 🟠 混合 | 代码 (JSON) + DB | 中 | 界面词条在代码 JSON 中，产品内容在 DB 中。 |

### 📦 商品与库存 (Product & Inventory)

| 功能点 | 当前状态 | 配置方式 | 灵活度 | 说明 |
| :--- | :--- | :--- | :--- | :--- |
| **基础信息 (Title/Desc)** | 🟢 动态 | 数据库 | 高 | 可在后台自由编辑。 |
| **规格属性 (Color/Size)** | 🟢 动态 | 数据库 (Attributes表) | 高 | 可自由增删属性和属性值。 |
| **分类管理 (Category)** | 🟢 动态 | 数据库 | 高 | 支持树形结构调整。 |
| **尺码表 (Size Chart)** | 🟢 动态 | 数据库 | 高 | 可创建模板并关联不同产品。 |
| **阶梯定价 (Tiered Price)** | 🟠 混合 | 逻辑已备 / 缺界面 | 中 | 代码支持计算，但后台缺录入框，目前不可用。 |

### 🛒 订单与交易 (Order & Trade)

| 功能点 | 当前状态 | 配置方式 | 灵活度 | 说明 |
| :--- | :--- | :--- | :--- | :--- |
| **订单状态流转** | 🔴 静态 | 代码逻辑 (Service) | 低 | 状态机 (Pending->Paid) 写死，不可自定义流程。 |
| **起订量 (MOQ)** | 🟢 动态 | 数据库 (SKU字段) | 高 | 每个 SKU 可独立设置 MOQ。 |
| **运费计算** | 🔴 静态 | N/A (未实现自动计算) | 低 | 目前依赖人工报价或固定规则。 |
| **税费规则** | 🔴 静态 | 代码/未实现 | 低 | 暂无动态税率配置引擎。 |
| **单据模板 (PI/Invoice)** | 🔴 静态 | 代码 (PDFKit) | 低 | 修改 PDF 格式/Logo 需改代码。 |

### 👥 用户与权限 (User & Permission)

| 功能点 | 当前状态 | 配置方式 | 灵活度 | 说明 |
| :--- | :--- | :--- | :--- | :--- |
| **用户角色** | 🔴 静态 | 代码 (Enum/Guard) | 低 | 角色 (Admin/User) 写死，不可动态创建新角色。 |
| **公司审核** | 🟢 动态 | 数据库 | 高 | 管理员可在后台审批公司资质。 |
| **销售代表分配** | 🟢 动态 | 数据库 | 高 | 可自由分配客户给销售。 |

---

## 3. 改进建议与优先级

为了提升系统的运营灵活性，建议按以下优先级将“静态”转为“动态”：

### 🚀 P0: 必须改进 (高业务价值)
1.  **阶梯定价 UI**: 虽然逻辑已就绪，但必须在后台添加输入界面，否则此功能无法通过运营手段落地。
2.  **汇率管理 UI**: 提供手动修正汇率的后台界面，应对剧烈波动，而不是纯依赖自动同步。

### 🚗 P1: 建议改进 (提升运维效率)
1.  **系统配置表 (Config Table)**: 在数据库建立 `SystemSettings` 表，迁移 SMTP、公司联系信息（用于发票页眉）、默认币种等配置。
2.  **单据模版配置**: 允许在后台上传 Invoice Logo 或修改公司抬头文本，无需改代码。

### 🚲 P2: 暂缓改进 (低频变更)
1.  **支付网关配置**: Stripe Key 极少变更，保持环境变量即可。
2.  **订单状态流转**: 除非业务模式大改，标准电商流程通常是固定的。

---

**总结**: 
如果希望实现“完全后台自由更改”，需要开发一个**“系统设置 (System Settings)”**模块，并将目前散落在 `.env` 和代码常量中的配置项迁移到数据库中。
