# SoleTrade ç¯å¢ƒå˜é‡é…ç½®æŒ‡å—

æœ¬æŒ‡å—å°†æŒ‡å¯¼æ‚¨å¦‚ä½•é…ç½®æœåŠ¡å™¨ä¸Šçš„ `.env` æ–‡ä»¶ï¼Œä»¥å¯ç”¨é‚®ä»¶é€šçŸ¥ã€åœ¨çº¿æ”¯ä»˜å’Œ WhatsApp è”ç³»åŠŸèƒ½ã€‚

âš ï¸ **æ³¨æ„**ï¼šè¿™äº›åŒ…å«æ•æ„Ÿä¿¡æ¯çš„é…ç½®**åªåº”åœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œä¿®æ”¹**ï¼Œè¯·å‹¿æäº¤åˆ° Git ä»“åº“ã€‚

---

## 1. ğŸ“§ é‚®ä»¶æœåŠ¡ (Email Configuration)
**ç”¨é€”**ï¼šç”¨äºå‘é€æ³¨å†Œæ¬¢è¿é‚®ä»¶ã€è¯¢ç›˜é€šçŸ¥ã€è®¢å•ç¡®è®¤ç­‰ã€‚
**æ¨è**ï¼šä½¿ç”¨ **QQé‚®ç®±** çš„ SMTP æœåŠ¡ï¼ˆç¨³å®šä¸”å…è´¹ï¼‰ã€‚

| å˜é‡å | å¡«å†™è¯´æ˜ | ç¤ºä¾‹ |
| :--- | :--- | :--- |
| `SMTP_HOST` | SMTP æœåŠ¡å™¨åœ°å€ | `smtp.qq.com` |
| `SMTP_PORT` | SMTP ç«¯å£ | `587` |
| `SMTP_USER` | æ‚¨çš„é‚®ç®±åœ°å€ | `123456@qq.com` |
| `SMTP_PASS` | **SMTP æˆæƒç ** (ä¸æ˜¯é‚®ç®±å¯†ç ) | `abcdefghijklmn` |

### ğŸ› ï¸ å¦‚ä½•è·å– QQ é‚®ç®±æˆæƒç ï¼Ÿ
1.  ç™»å½•ç½‘é¡µç‰ˆ [QQé‚®ç®±](https://mail.qq.com)ã€‚
2.  ç‚¹å‡»é¡¶éƒ¨ã€è®¾ç½®ã€‘->ã€è´¦å·ã€‘ã€‚
3.  å‘ä¸‹æ»šåŠ¨æ‰¾åˆ°ã€POP3/IMAP/SMTP/Exchange/CardDAV/CalDAVæœåŠ¡ã€‘ã€‚
4.  å¼€å¯ **"POP3/SMTPæœåŠ¡"**ã€‚
5.  ç‚¹å‡»ã€ç”Ÿæˆæˆæƒç ã€‘ï¼Œå¤åˆ¶ç”Ÿæˆçš„ 16 ä½å­—ç¬¦ä¸²ã€‚

---

## 2. ğŸ’³ æ”¯ä»˜æœåŠ¡ (Stripe Payment)
**ç”¨é€”**ï¼šå¯ç”¨ä¿¡ç”¨å¡åœ¨çº¿æ”¯ä»˜åŠŸèƒ½ã€‚å¦‚æœæ‚¨åªéœ€è¦çº¿ä¸‹è½¬è´¦ï¼Œå¯ä»¥ç•™ç©ºã€‚

| å˜é‡å | å¡«å†™è¯´æ˜ | è·å–ä½ç½® |
| :--- | :--- | :--- |
| `STRIPE_PUBLISHABLE_KEY` | å…¬é’¥ (ä»¥ `pk_` å¼€å¤´) | Dashboard -> Developers -> API keys |
| `STRIPE_SECRET_KEY` | ç§é’¥ (ä»¥ `sk_` å¼€å¤´) | Dashboard -> Developers -> API keys |
| `STRIPE_WEBHOOK_SECRET` | Webhook ç­¾åå¯†é’¥ (ä»¥ `whsec_` å¼€å¤´) | Dashboard -> Developers -> Webhooks |

### ğŸ› ï¸ å¦‚ä½•é…ç½® Stripe Webhookï¼Ÿ
1.  ç™»å½• [Stripe Dashboard](https://dashboard.stripe.com/)ã€‚
2.  è¿›å…¥ **Developers** -> **Webhooks** -> **Add endpoint**ã€‚
3.  **Endpoint URL** å¡«: `https://aif1688.com/api/stripe/webhook`
4.  **Select events** å‹¾é€‰: `payment_intent.succeeded`, `payment_intent.payment_failed`ã€‚
5.  åˆ›å»ºåï¼Œç‚¹å‡» **"Reveal"** è·å–å¯†é’¥ã€‚

---

## 3. ğŸ’¬ è”ç³»æ–¹å¼ (WhatsApp)
**ç”¨é€”**ï¼šç½‘ç«™æ‚¬æµ®æŒ‰é’®å’Œäº§å“é¡µ "Contact" æŒ‰é’®çš„ç›®æ ‡å·ç ã€‚

| å˜é‡å | å¡«å†™è¯´æ˜ | ç¤ºä¾‹ |
| :--- | :--- | :--- |
| `NEXT_PUBLIC_WHATSAPP_NUMBER` | å›½é™…æ ¼å¼æ‰‹æœºå· (å»æ‰ `+` å·) | `8613800000000` (ä¸­å›½)<br>`15551234567` (ç¾å›½) |

---

## ğŸš€ æœåŠ¡å™¨æ“ä½œæ­¥éª¤

è¯·æŒ‰ä»¥ä¸‹æ­¥éª¤åœ¨æœåŠ¡å™¨ä¸Šå¡«å…¥ä¸Šè¿°ä¿¡æ¯ï¼š

### ç¬¬ä¸€æ­¥ï¼šç™»å½•å¹¶æ‰“å¼€æ–‡ä»¶
```bash
ssh root@47.251.97.162
cd ~/soletrade
nano .env
```

### ç¬¬äºŒæ­¥ï¼šç¼–è¾‘å†…å®¹
ä½¿ç”¨é”®ç›˜æ–¹å‘é”®ç§»åŠ¨å…‰æ ‡ï¼Œå¡«å…¥æ‚¨çš„çœŸå®ä¿¡æ¯ã€‚
```env
# ç¤ºä¾‹é…ç½®
SMTP_USER=123456@qq.com
SMTP_PASS=è¿™é‡Œå¡«æ‚¨çš„æˆæƒç 
NEXT_PUBLIC_WHATSAPP_NUMBER=8613900000000
```

### ç¬¬ä¸‰æ­¥ï¼šä¿å­˜å¹¶é€€å‡º
1.  æŒ‰ `Ctrl + O` (Write Out)ã€‚
2.  æŒ‰ `Enter` ç¡®è®¤æ–‡ä»¶åã€‚
3.  æŒ‰ `Ctrl + X` (Exit) é€€å‡ºç¼–è¾‘å™¨ã€‚

### ç¬¬å››æ­¥ï¼šé‡å¯æœåŠ¡ (å¿…é¡»)
é…ç½®ä¿®æ”¹åï¼Œå¿…é¡»é‡å¯å®¹å™¨æ‰èƒ½ç”Ÿæ•ˆï¼š
```bash
docker compose -f docker-compose.prod.yml up -d --build --force-recreate
```

---
**æç¤º**ï¼šå¦‚æœæ‚¨æš‚æ—¶æ²¡æœ‰ Stripe è´¦å·ï¼Œå¯ä»¥ç•™ç©ºç›¸å…³å­—æ®µï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨é™çº§ä¸ºä»…æ”¯æŒçº¿ä¸‹è½¬è´¦æ¨¡å¼ï¼Œä¸å½±å“ç½‘ç«™å…¶ä»–åŠŸèƒ½ã€‚

è¯·å°è¯•ä»¥ä¸‹å‡ ç§è§£å†³æ–¹æ³•ï¼ˆæŒ‰é¡ºåºå°è¯•ï¼‰ï¼š

### æ–¹æ³•ä¸€ï¼šæ£€æŸ¥è¾“å…¥æ³•ï¼ˆæœ€å¸¸è§åŸå› ï¼‰
è¯·ç¡®ä¿æ‚¨çš„è¾“å…¥æ³•å·²ç» åˆ‡æ¢åˆ°äº†è‹±æ–‡æ¨¡å¼ ï¼ˆæŒ‰ Shift åˆ‡æ¢ï¼‰ã€‚
å¦‚æœæ˜¯ä¸­æ–‡æ¨¡å¼ï¼Œ Ctrl + X å¾€å¾€ä¼šè¢«æ‹¦æˆªæˆ–æ— æ•ˆã€‚

### æ–¹æ³•äºŒï¼šç›´æ¥æš´åŠ›è¦†ç›–ï¼ˆæœ€ç®€å•æ¨èï¼‰
å¦‚æœæ‚¨è§‰å¾—ç¼–è¾‘å™¨å¤ªéš¾ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨å®ƒï¼
è¯·ç›´æ¥ å¤åˆ¶ ä¸‹é¢è¿™æ®µä»£ç ï¼Œåœ¨æœåŠ¡å™¨ç»ˆç«¯é‡Œ ç²˜è´´å¹¶å›è½¦ ã€‚è¿™ä¼šç›´æ¥ç”Ÿæˆå¥½æ–‡ä»¶ï¼Œä¸éœ€è¦æ‚¨æ‰‹åŠ¨ç¼–è¾‘ä¿å­˜ï¼š

```
catÂ >Â .envÂ <<EOF
#Â Security
JWT_SECRET=production-secret-key-123

#Â EmailÂ Configuration
SMTP_HOST=smtp.qq.com
SMTP_PORT=587
SMTP_USER=414635430@qq.com
SMTP_PASS=srdjsalkxsejbjed

#Â Domain
DOMAIN_NAME=aif1688.com

#Â ContactÂ Configuration
NEXT_PUBLIC_WHATSAPP_NUMBER=86186503
52529

#Â StripeÂ (Optional)
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_PUBLISHABLE_KEY=
EOF
```
### æ–¹æ³•ä¸‰ï¼šå¦‚ä½•ä»å¡ä½çš„ nano ä¸­é€€å‡ºæ¥ï¼Ÿ
å¦‚æœæ‚¨ç°åœ¨å¡åœ¨é‚£ä¸ªç•Œé¢åŠ¨ä¸äº†ï¼š

1. å°è¯•æŒ‰ Ctrl + C ï¼ˆå¼ºåˆ¶ä¸­æ–­ï¼‰ã€‚
2. æˆ–è€…æŒ‰ F2 ï¼ˆæœ‰äº›ç‰ˆæœ¬çš„ nano ç”¨ F2 ä¿å­˜ï¼‰ã€‚
3. å¦‚æœå®åœ¨ä¸è¡Œï¼Œç›´æ¥å…³é—­é‚£ä¸ªç»ˆç«¯çª—å£ï¼Œé‡æ–°è¿æ¥ SSH å³å¯ã€‚æ–‡ä»¶æ²¡ä¿å­˜æ²¡å…³ç³»ï¼Œç”¨ä¸Šé¢çš„ æ–¹æ³•äºŒ é‡å†™ä¸€éå°±è¡Œã€‚
å»ºè®®æ‚¨ç›´æ¥ä½¿ç”¨ æ–¹æ³•äºŒ ï¼Œä¸€é”®æå®šï¼Œçœå¿ƒçœåŠ›ï¼